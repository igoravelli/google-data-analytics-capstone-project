# Process to clean all dataframes

### Dataframe schema

| Column | Description | DType |
| :--- | :--- | :--- |
| `realSum` | the total price of the listing | integer |
| `room_type` | private/shared/entire home/apt | string |
| `room_shared` | indicate if the room is shared | bool |
| `room_private` | indicate if the room is private | bool |
| `person_capacity` | number of people capacity in the room | integer |
| `host_is_superhost` | boolean value indicating if host is a superhost or not | bool |
| `multi` | indicator whether listing is for multiple rooms or not | integer |
| `biz` | business indicator | integer |
| `cleanliness_rating` | rating of the clean level of the room | integer |
| `guest_satisfaction_overall` | overall rating from guests camparing all listings offered by host | integer |
| `bedrooms` | quantity of bedrooms available in the listing | integer |
| `dist` | distance from city center | float |
| `metro_dist` | distance from closest subway station | float |
| `lng & lat` | coordinates for location identification | float |

# Install & load packages
```{r install & load packages}
install.packages("dplyr")
library(dplyr)
```


# Load files

```{r load all raw files}
setwd("/home/igorregly/google-data-analytics-capstone-project/csv_files/")
dfs <- list()
listcsv <- dir(pattern = "*.csv")

for (k in 1:length(listcsv)) {
    dfs[[k]] <- read.csv(listcsv[k])
}
```

---
# Cleaning Functions
## Droping null rows

```{r drop null values of a DataFrame}

drop_na_values <- function(df) {
    df <- na.omit(df)

    return(df)
}
```

## Checking duplicates

```{r remove duplicated rows}
remove_duplicated_rows <- function(df) {
    df <- df %>% distinct()

    return(df)
}
```

# Applying functions
```{r}
cleaned_dfs <- list()

for (df in dfs) {
    df <- drop_na_values(df)
    df <- remove_duplicated_rows(df)

    append(cleaned_dfs, df)
}
```